import router from '@ohos.router'
import prompt from '@ohos.prompt'

interface RouterParams {
  latitude?: number
  longitude?: number
}

@Entry
@Component
export struct MapPage {
  @State latitude: number = 0
  @State longitude: number = 0
  @State currentLocation: string = ''

  aboutToAppear() {
    const params = router.getParams()
    if (params) {
      this.latitude = (params as RouterParams).latitude || 0
      this.longitude = (params as RouterParams).longitude || 0
      this.currentLocation = `çº¬åº¦: ${this.latitude.toFixed(6)}, ç»åº¦: ${this.longitude.toFixed(6)}`
    }
  }

  handleCheckIn() {
    // æ¨¡æ‹Ÿç­¾åˆ°æˆåŠŸ
    prompt.showToast({
      message: 'ç­¾åˆ°æˆåŠŸï¼',
      duration: 2000
    })
    
    setTimeout(() => {
      router.back()
    }, 1000)
  }

  build() {
    Column() {
      // å¤´éƒ¨
      Row() {
        Image($r('app.media.ic_back'))
          .width(24)
          .height(24)
          .onClick(() => {
            router.back()
          })
        
        Text('å®šä½ç­¾åˆ°')
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .margin({ left: 16 })
        
        Blank()
      }
      .width('100%')
      .height(56)
      .padding({ left: 16, right: 16 })
      .backgroundColor(Color.White)

      // åœ°å›¾åŒºåŸŸ
      Column() {
        // æ¨¡æ‹Ÿåœ°å›¾
        Column() {
          Text('ğŸ“')
            .fontSize(48)
            .margin({ bottom: 16 })
          
          Text('å½“å‰ä½ç½®')
            .fontSize(18)
            .fontWeight(FontWeight.Bold)
            .margin({ bottom: 8 })
          
          Text(this.currentLocation || 'è·å–ä½ç½®ä¸­...')
            .fontSize(14)
            .fontColor('#8E8E93')
            .textAlign(TextAlign.Center)
            .margin({ bottom: 32 })
          
          Button('ç­¾åˆ°')
            .fontSize(16)
            .fontWeight(FontWeight.Bold)
            .backgroundColor('#007AFF')
            .fontColor(Color.White)
            .width(120)
            .height(44)
            .borderRadius(22)
            .onClick(() => {
              this.handleCheckIn()
            })
        }
        .width('100%')
        .height(400)
        .backgroundColor('#F8F8F8')
        .borderRadius(12)
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
        .margin({ top: 20 })
      }
      .width('100%')
      .padding({ left: 16, right: 16 })
      .layoutWeight(1)

      // è¯´æ˜æ–‡å­—
      Column() {
        Text('ç­¾åˆ°è¯´æ˜')
          .fontSize(16)
          .fontWeight(FontWeight.Bold)
          .margin({ bottom: 8 })
        
        Text('â€¢ è¯·ç¡®ä¿æ‚¨åœ¨æ´»åŠ¨ç°åœºé™„è¿‘')
          .fontSize(14)
          .fontColor('#8E8E93')
          .margin({ bottom: 4 })
        
        Text('â€¢ ç­¾åˆ°èŒƒå›´ï¼šæ´»åŠ¨åœ°ç‚¹å‘¨å›´100ç±³')
          .fontSize(14)
          .fontColor('#8E8E93')
          .margin({ bottom: 4 })
        
        Text('â€¢ æ¯ä¸ªæ´»åŠ¨åªèƒ½ç­¾åˆ°ä¸€æ¬¡')
          .fontSize(14)
          .fontColor('#8E8E93')
      }
      .width('100%')
      .padding({ left: 16, right: 16, bottom: 20 })
      .alignItems(HorizontalAlign.Start)
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F2F2F7')
  }
} 